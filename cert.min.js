/*
 acrobat-js - http://github.com/fabianonunes/acrobat-js
 Copyright (c) 2011, Fabiano Nunes
 Released under the BSD License.
*/var AcrobatJs={paths:{cert1:"/c/status1.pdf",cert6:"/c/status6.pdf"},insertDoc:app.trustedFunction(function(a){app.beginPriv(),this.insertPages({nPage:this.numPages-1,cPath:a}),this.pageNum=this.numPages-1,app.endPriv()}),addCert6:function(){AcrobatJs.insertDoc(AcrobatJs.paths.cert6);var a=this.getField("numproc"),b=/[1-9]\d{0,6}-\d{2}\.\d{4}\.\d\.\d{2}\.\d{4}/;a.value=b.exec(this.documentFileName)||"Digite o número do processo"},sortBookmarks:function(a){var b=this.pageNum,c=a.children,d={},e,f;if(!c)return;for(e=0;f=c[e++];)f.execute(),f.pageNum=this.pageNum,f.order=e,d[f.pageNum]={},f.children&&AcrobatJs.sortBookmarks(f);c.sort(function(a,b){return a.pageNum-b.pageNum||a.order-b.order});for(e=0;f=c[e++];){if(d[f.pageNum][f.name]&&!f.children){f.remove();continue}a.insertChild(f,c.length),d[f.pageNum][f.name]=!0}this.pageNum=b},initialize:function(){Utils.stickAll(AcrobatJs);var a="event.rc = (event.target != null);",b="AcrobatJs.sortBookmarks(this.bookmarkRoot);",c="Ordenar &Marcadores";app.addMenuItem({cName:"sortBookmarks",cUser:c,cParent:"Tools",cEnable:a,cExec:b,nPos:0}),app.addToolButton({cName:"sortBkmButton",cLabel:c,cEnable:a,cExec:b,nPos:-1}),app.addMenuItem({cName:"addCert6",cUser:"Certidão - Status &6",cParent:"Tools",cEnable:a,cExec:"AcrobatJs.addCert6();",nPos:0}),app.addMenuItem({cName:"addCert1",cUser:"Certidão - Status &1",cParent:"Tools",cEnable:a,cExec:"AcrobatJs.insertDoc(AcrobatJs.paths.cert1);",nPos:0})}},Utils={stick:function(a){return function(){return a.apply(event.target,Array.prototype.slice.call(arguments))}},stickAll:function(a){for(var b in a)Utils.isFunction(a[b])&&(a[b]=Utils.stick(a[b]))},isFunction:function(a){return Object.prototype.toString.call(a)=="[object Function]"}};AcrobatJs.initialize();